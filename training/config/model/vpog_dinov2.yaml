# VPOG Model with DINOv2 ViT-L/14 Encoder
defaults:
  - vpog
  - encoder: dinov2_vitl14
  - _self_

# Override patch_size for DINOv2 (uses 14x14 patches)
patch_size: 14

# Component dimensions stay at 1024 (DINOv2-L has same dim as CroCo-Large)
# No need to override aa_module, classification_head, flow_head

# Override flow head patch size
flow_head:
  cfg:
    ps: 14


# Classification head configuration
classification_head:
  _target_: vpog.models.classification_head.ClassificationHead
  dim: 1024
  temperature: 1.0  # Softmax temperature for similarity scores
  use_mlp: true
  mlp_hidden_dim: 512
  dropout: 0.0

# Flow head configuration
flow_head:
  _target_: vpog.models.flow_head.FlowHead
  dim: 1024
  patch_size: 14  # Match DINOv2 patch_size
  hidden_dims: [512, 256, 128]  # MLP decoder layers
  use_confidence: true
  dropout: 0.0

# Training configuration
training:
  batch_size: 16
  num_epochs: 100
  num_workers: 8
  
  optimizer:
    type: "adamw"
    lr: 1.0e-4
    weight_decay: 0.05
    betas: [0.9, 0.999]
  
  lr_scheduler:
    type: "cosine"
    warmup_epochs: 5
    min_lr: 1.0e-6
  
  loss_weights:
    classification: 1.0
    flow: 1.0
    epro_pnp: 0.1
    weight_regularization: 0.01

# Inference configuration
inference:
  cluster_mode:
    enabled: true
    top_k: 4
    confidence_threshold: 0.5
  
  global_mode:
    enabled: true
    chunk_size: 32
    confidence_threshold: 0.5
  
  correspondence:
    min_matches: 4
    max_matches: 100
    use_flow: true
    flow_confidence_threshold: 0.5
